apiVersion: kubegres.reactive-tech.io/v1
kind: Kubegres
metadata:
  name: git-indexer-postgres
spec:
  replicas: 1
  image: postgres:14.5
  database:
    size: 3Gi
  env:
  # skip all the security here :))
  - name: POSTGRES_PASSWORD
    valueFrom:
      secretKeyRef:
        name: postgres-secret
        key: postgres_password
  - name: POSTGRES_REPLICATION_PASSWORD
    valueFrom:
      secretKeyRef:
        name: postgres-secret
        key: postgres_replication_password
  - name: POSTGRES_USER
    valueFrom:
      secretKeyRef:
        name: postgres-secret
        key: postgres_user
  - name: POSTGRES_DB
    valueFrom:
      secretKeyRef:
        name: postgres-secret
        key: postgres_db
  - name: POSTGRES_MY_DBPASSWORD
    valueFrom:
      secretKeyRef:
        name: postgres-secret
        key: postgres_my_dbpassword

